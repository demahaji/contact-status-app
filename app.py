ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¸ã¨ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹
ãƒãƒ£ãƒƒãƒˆå±¥æ­´

ã‚ãªãŸ:
https://github.com/demahaji/contact-status-app/tree/main
ã“ã‚ŒãŒä¸Šæ‰‹ãã„ã‹ãªã„
ChatGPT:
GitHubãƒªãƒã‚¸ãƒˆãƒªï¼ˆhttps://github.com/demahaji/contact-status-app/tree/mainï¼‰ã«é–¢ã—ã¦ã€Œä¸Šæ‰‹ãã„ã‹ãªã„ã€ã¨ã®ã“ã¨ã§ã™ãŒã€ã‚‚ã†å°‘ã—è©³ã—ãçŠ¶æ³ã‚’æ•™ãˆã¦ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ
ãŸã¨ãˆã°ã€ä»¥ä¸‹ã®ã‚ˆã†ãªç‚¹ã‚’æ•™ãˆã¦ã„ãŸã ã‘ã‚‹ã¨ã€çš„ç¢ºã«ã‚µãƒãƒ¼ãƒˆã§ãã¾ã™ã€‚

ğŸ” ç¢ºèªã—ãŸã„ãƒã‚¤ãƒ³ãƒˆ
ã©ã®æ“ä½œã§å•é¡ŒãŒèµ·ãã¦ã„ã‚‹ã‹ï¼Ÿ

cloneã§ããªã„ï¼Ÿ

Streamlitã‚¢ãƒ—ãƒªãŒèµ·å‹•ã—ãªã„ï¼Ÿ

LINEé€šçŸ¥ãŒé€ã‚Œãªã„ï¼Ÿ

ã©ã‚“ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå‡ºã‚‹ã‹ï¼Ÿ

ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®ã‚¨ãƒ©ãƒ¼å†…å®¹ã‚„ãƒ­ã‚°ãŒã‚ã‚‹ã¨åŠ©ã‹ã‚Šã¾ã™ã€‚

ã©ã®ã‚ˆã†ãªç’°å¢ƒã§å®Ÿè¡Œã—ã¦ã„ã‚‹ã‹ï¼Ÿ

ãƒ­ãƒ¼ã‚«ãƒ«PCï¼Ÿï¼ˆWindows/Macï¼‰

GitHub Codespacesï¼ŸStreamlit Community Cloudï¼Ÿ

æ„å›³ã—ã¦ã„ã‚‹å‹•ä½œã¨å®Ÿéš›ã®å‹•ä½œã®é•ã„

ã‚ˆã‘ã‚Œã°ã€æ¬¡ã®ã„ãšã‚Œã‹ã‚’ãŠé€ã‚Šãã ã•ã„ï¼š

å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ã¨å‡ºåŠ›ã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸã¨ãã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ

è©²å½“ã®ã‚³ãƒ¼ãƒ‰ã®ä¸€éƒ¨ï¼ˆã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸç®‡æ‰€ï¼‰

ã™ãã«åŸå› ã‚’ç‰¹å®šã§ãã‚‹ã‚ˆã†ã«å…¨åŠ›ã§ãŠæ‰‹ä¼ã„ã—ã¾ã™ã€‚ãŠå¾…ã¡ã—ã¦ã„ã¾ã™ï¼

ã‚ãªãŸ:
LINEã®é€šçŸ¥ã¯ä»Šã¯ã„ã„ã§ã™ã€‚
æ—¥ä»˜ã§ãƒ•ã‚¡ã‚¤ãƒ«ãŒé–‹ã‹ãªã„
ChatGPT:
äº†è§£ã—ã¾ã—ãŸã€ã€Œæ—¥ä»˜ã§ãƒ•ã‚¡ã‚¤ãƒ«ãŒé–‹ã‹ãªã„ã€ã¨ã„ã†ç‚¹ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã—ã¾ã™ã€‚

ãŠãã‚‰ãã€Streamlit ã‚¢ãƒ—ãƒªãŒæ—¥ä»˜ã‚’å…ƒã« Excel ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã“ã†ã¨ã—ã¦ã„ã‚‹ã‘ã©ã€å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„ã€ã¾ãŸã¯ãƒ‘ã‚¹ãŒé–“é•ã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

ğŸ” ã¾ãšç¢ºèªï¼šã‚³ãƒ¼ãƒ‰ä¸Šã§æ—¥ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã„ã¦ã„ã‚‹ç®‡æ‰€
app.py ã«æ¬¡ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹ã¯ãšã§ã™ï¼š

today = datetime.today().strftime('%Y-%m-%d')
file_path = f"data/{today}.xlsx"
df = pd.read_excel(file_path)
ã“ã®å ´åˆã€ã‚¢ãƒ—ãƒªãŒæ¢ã—ã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã¯ï¼š

data/2025-05-24.xlsx
ã®ã‚ˆã†ãªãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚

âœ… ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ
data/ ãƒ•ã‚©ãƒ«ãƒ€ãŒã‚ã‚‹ã‹ï¼Ÿ
contact-status-app/data/ ã«ãƒ•ã‚©ãƒ«ãƒ€ãŒå­˜åœ¨ã—ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚

ä»Šæ—¥ã®æ—¥ä»˜ï¼ˆä¾‹ï¼š2025-05-24.xlsxï¼‰ã¨ã„ã†åå‰ã®Excelãƒ•ã‚¡ã‚¤ãƒ«ãŒå…¥ã£ã¦ã„ã‚‹ã‹ï¼Ÿ
ãƒ•ã‚¡ã‚¤ãƒ«åãŒ 2025-5-24.xlsx ã‚„ 05-24-2025.xlsx ãªã©ã€å½¢å¼ãŒã‚ºãƒ¬ã¦ã„ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚

ãƒ•ã‚¡ã‚¤ãƒ«åãŒæ­£ã—ãã¦ã‚‚ã€æ‹¡å¼µå­ãŒ .xls ã‚„ .csv ãªã©ã§ã¯ãªã„ã‹ï¼Ÿ
pd.read_excel() ã¯ .xlsx ã‚’å‰æã«ã—ã¦ã„ã‚‹ã“ã¨ãŒå¤šã„ã§ã™ã€‚

ğŸ›  è§£æ±ºç­–
ğŸ’¡ å¯¾å¿œ 1ï¼šãƒ•ã‚¡ã‚¤ãƒ«åã®è‡ªå‹•ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ã‚’ç¢ºèªãƒ»ä¿®æ­£
from datetime import datetime

today = datetime.today().strftime('%Y-%m-%d')
file_path = f"data/{today}.xlsx"

if os.path.exists(file_path):
    df = pd.read_excel(file_path)
else:
    st.error(f"ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: {file_path}")
ğŸ’¡ å¯¾å¿œ 2ï¼šStreamlit UIã§æ—¥ä»˜ã‚’é¸ã¹ã‚‹ã‚ˆã†ã«ã™ã‚‹
selected_date = st.date_input("æ—¥ä»˜ã‚’é¸æŠ", datetime.today())
file_path = f"data/{selected_date.strftime('%Y-%m-%d')}.xlsx"
if os.path.exists(file_path):
    df = pd.read_excel(file_path)
else:
    st.error(f"ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: {file_path}")
ğŸš€ æ¬¡ã«ã©ã†ã—ã¾ã™ã‹ï¼Ÿ
ã‚³ãƒ¼ãƒ‰ã®è©²å½“éƒ¨åˆ†ã‚’è²¼ã£ã¦ã„ãŸã ã‘ã‚Œã°ã€æ­£ç¢ºã«ä¿®æ­£ææ¡ˆã‚‚å¯èƒ½ã§ã™ã€‚

data/ ãƒ•ã‚©ãƒ«ãƒ€ã®ä¸­èº«ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«åä¸€è¦§ï¼‰ã‚’æ•™ãˆã¦ã„ãŸã ãã®ã‚‚ã‚¢ãƒªã§ã™ã€‚

ã”å¸Œæœ›ã‚ã‚Œã°ã€æ—¥ä»˜é¸æŠUIä»˜ãã§ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æ¸ˆã¿ã®ã‚³ãƒ¼ãƒ‰ã‚’ã¾ã‚‹ã”ã¨ææ¡ˆã—ã¾ã™ï¼

ã‚ãªãŸ:
ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ
ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ
ChatGPT:
ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼ç”»åƒã‹ã‚‰ç¢ºèªã™ã‚‹ã¨ã€ç¾åœ¨ã® data ãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«åã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ãŠã‚Šã€ã€Œæ—¥ä»˜ã ã‘ã®åå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆä¾‹ï¼š2025-05-24.xlsxï¼‰ã€ã¨ã€ã€Œé•·ã„ãƒ•ã‚¡ã‚¤ãƒ«åï¼ˆä¾‹ï¼šJP-DEMA-DEJ3...2025-05-24.xlsxï¼‰ã€ã®2ç¨®é¡ãŒæ··åœ¨ã—ã¦ã„ã¾ã™ã€‚

â—å•é¡Œç‚¹
Streamlitã‚¢ãƒ—ãƒªãŒä»¥ä¸‹ã®ã‚ˆã†ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã‚“ã§ã„ã‚‹ã¨ä»®å®šã—ã¾ã™ï¼š

today = datetime.today().strftime('%Y-%m-%d')
file_path = f"data/{today}.xlsx"
df = pd.read_excel(file_path)
â†’ ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ data/2025-05-24.xlsx ã®ã‚ˆã†ãªçŸ­ã„åå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã—ã‹æ¢ã—ã¾ã›ã‚“ã€‚

ã§ã™ãŒã€å®Ÿéš›ã®ãƒ•ã‚¡ã‚¤ãƒ«åã¯ï¼š

JP-DEMA-DEJ3-week-21-Daily_ContactCompliance-2025-05-24.xlsx
ãªã®ã§ã€ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãšã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚

âœ… è§£æ±ºæ–¹æ³•ï¼ˆæŸ”è»Ÿã«æ—¥ä»˜ã‚’å«ã‚€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¢ã™ï¼‰
data ãƒ•ã‚©ãƒ«ãƒ€å†…ã§ æ—¥ä»˜ã‚’å«ã‚€ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æ¢ã™æ–¹æ³• ã«åˆ‡ã‚Šæ›¿ãˆã‚‹ã¨è§£æ±ºã§ãã¾ã™ã€‚

ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’ app.py ã«æ›¸ãæ›ãˆã¦ã¿ã¦ãã ã•ã„ï¼š

import os
import glob
from datetime import datetime
import pandas as pd
import streamlit as st

# ä»Šæ—¥ã®æ—¥ä»˜ï¼ˆä¾‹ï¼š2025-05-24ï¼‰
today = datetime.today().strftime('%Y-%m-%d')

# ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ä¸€è‡´ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¢ã™
file_pattern = f"data/*{today}*.xlsx"
file_list = glob.glob(file_pattern)

if file_list:
    file_path = file_list[0]  # æœ€åˆã«è¦‹ã¤ã‹ã£ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨
    df = pd.read_excel(file_path)
    st.success(f"èª­ã¿è¾¼ã‚“ã ãƒ•ã‚¡ã‚¤ãƒ«: {os.path.basename(file_path)}")
    st.dataframe(df)
else:
    st.error(f"{today} ã‚’å«ã‚€Excelãƒ•ã‚¡ã‚¤ãƒ«ãŒ data ãƒ•ã‚©ãƒ«ãƒ€ã«è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚")
âœ¨ è£œè¶³ï¼šã‚‚ã£ã¨æ±ç”¨çš„ã«ã™ã‚‹ãªã‚‰
Streamlitã®date_inputã§æ—¥ä»˜ã‚’é¸ã¹ã‚‹ã‚ˆã†ã«ã—ã¦ã€éå»ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚èª­ã‚ã‚‹ã‚ˆã†ã«ã™ã‚‹ã¨ä¾¿åˆ©ã§ã™ã€‚å¿…è¦ã§ã‚ã‚Œã°ãã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚‚ã™ãä½œã‚Œã¾ã™ã€‚

æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
ä¸Šè¨˜ã‚³ãƒ¼ãƒ‰ã‚’ app.py ã«å…¥ã‚Œã¦ã¿ã¦ãã ã•ã„

ã‚‚ã— glob ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒæœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ã‚ã‚Œã°ã€æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãªã®ã§ãã®ã¾ã¾ä½¿ãˆã¾ã™

ä»–ã«ã‚‚æ—¥ä»˜å½¢å¼ã‚„ã‚¨ãƒ©ãƒ¼å¯¾å¿œãªã©èª¿æ•´ã—ãŸã„ç‚¹ãŒã‚ã‚Œã°æ•™ãˆã¦ãã ã•ã„ï¼

ã”å¸Œæœ›ãŒã‚ã‚Œã°ãã®ã¾ã¾è²¼ã‚Šæ›¿ãˆç”¨ã«å…¨ä½“ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¾ã™ã€‚

ã‚ãªãŸ:
import streamlit as st
import pandas as pd
import datetime
import requests
from pathlib import Path

# å®šæ•°å®šç¾©
DATA_FOLDER = Path("data")
FREE_COMMENT_FILE = DATA_FOLDER / "free_comment.txt"
CHANNEL_ACCESS_TOKEN = st.secrets["line"]["channel_access_token"]

# ã‚¿ã‚¤ãƒˆãƒ«
st.title("ContactçŠ¶æ³å¯è¦–åŒ–ã‚¢ãƒ—ãƒªğŸ“Š")

# æ—¥ä»˜é¸æŠ
selected_date = st.date_input("ğŸ“… ç¢ºèªã™ã‚‹æ—¥ä»˜ã‚’é¸æŠ", datetime.date.today())
file_date_str = selected_date.strftime("%Y-%m-%d")
file_path = DATA_FOLDER / f"{file_date_str}.xlsx"

# ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
if file_path.exists():
    df = pd.read_excel(file_path)
else:
    st.error("æŒ‡å®šã•ã‚ŒãŸæ—¥ä»˜ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚")
    st.stop()

# æœªå¯¾å¿œãƒ‡ãƒ¼ã‚¿æŠ½å‡º
no_contact_df = df[df["contact_status"] == "no_contact"]
impact_drivers = df[df["impact"] == "high"]["driver_name"].unique()

# è¡¨ç¤º
st.subheader("ğŸ“Œ æœªå¯¾å¿œãƒ‰ãƒ©ã‚¤ãƒãƒ¼ä¸€è¦§")
if no_contact_df.empty:
    st.success("æœªå¯¾å¿œã®ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã¯ã„ã¾ã›ã‚“ã€‚")
else:
    st.dataframe(no_contact_df[["driver_name", "detail"]])

st.subheader("ğŸš€ æ”¹å–„ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã®é«˜ã„ãƒ‰ãƒ©ã‚¤ãƒãƒ¼")
if len(impact_drivers) > 0:
    st.write("ã€".join(impact_drivers))
else:
    st.write("è©²å½“è€…ãªã—")

# ç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›
st.subheader("ğŸ“ ç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›")
if FREE_COMMENT_FILE.exists():
    default_comment = FREE_COMMENT_FILE.read_text(encoding="utf-8")
else:
    default_comment = ""
free_comment = st.text_area("æ”¹å–„ã®ãƒã‚¤ãƒ³ãƒˆã‚„åŠ±ã¾ã—ã‚³ãƒ¡ãƒ³ãƒˆãªã©", value=default_comment, height=150)
FREE_COMMENT_FILE.write_text(free_comment, encoding="utf-8")

# ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç”Ÿæˆé–¢æ•°ï¼ˆ1é€šç›®ï¼‰
def generate_message(no_contact_df: pd.DataFrame, selected_date: datetime.date) -> str:
    date_str = selected_date.strftime("%-mæœˆ%-dæ—¥")
    message_lines = [f"ğŸ“¢ã€æœªå¯¾å¿œãƒ‰ãƒ©ã‚¤ãƒãƒ¼é€£çµ¡ã€‘{date_str}æ™‚ç‚¹\n"]

    grouped = no_contact_df.groupby("driver_name")
    for name, group in grouped:
        count = len(group)
        message_lines.append(f"ğŸš¨ {name} ã•ã‚“ï¼ˆæœªå¯¾å¿œ {count} ä»¶ï¼‰")

    message_lines.append("\nã”å¯¾å¿œã®ã»ã©ã€ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ã€‚")
    return "\n".join(message_lines)

# LINEé€ä¿¡é–¢æ•°ï¼ˆMessaging API ä½¿ç”¨ï¼‰
def send_line_message(to: str, message: str, token: str):
    headers = {
        "Content-Type": "application/json",
        "Authorization": f"Bearer {token}"
    }
    payload = {
        "to": to,
        "messages": [
            {
                "type": "text",
                "text": message
            }
        ]
    }
    response = requests.post("https://api.line.me/v2/bot/message/push", json=payload, headers=headers)
    return response.status_code, response.text

# ãƒ•ãƒ©ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹
sent_marker_path = DATA_FOLDER / f"message1_sent_flag_{file_date_str}.txt"
comment_sent_marker_path = DATA_FOLDER / f"message2_sent_flag_{file_date_str}.txt"

# ã¾ã¨ã‚ã¦é€ä¿¡ãƒœã‚¿ãƒ³
st.subheader("âœ… å€‹åˆ¥æ”¹å–„ãƒ¬ãƒãƒ¼ãƒˆï¼‹ç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆã¾ã¨ã‚ã¦é€šçŸ¥")
group_id = st.secrets["line"]["group_id"]

if st.button("ğŸ“¬ã¾ã¨ã‚ã¦é€ä¿¡ï¼ˆ1é€šç›®ï¼‹2é€šç›®ï¼‰"):
    # 1é€šç›®ï¼šå€‹åˆ¥ãƒ¬ãƒãƒ¼ãƒˆ
    if len(no_contact_df) == 0:
        st.warning("æœªå¯¾å¿œã®ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ãŒã„ã¾ã›ã‚“ã€‚1é€šç›®ã®é€ä¿¡ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã™ã€‚")
    else:
        message1 = generate_message(no_contact_df, selected_date)
        status1, text1 = send_line_message(group_id, message1, CHANNEL_ACCESS_TOKEN)
        if status1 == 200:
            st.success("âœ… 1é€šç›®ï¼ˆå€‹åˆ¥ãƒ¬ãƒãƒ¼ãƒˆï¼‰ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚")
            sent_marker_path.touch()
        else:
            st.error(f"âŒ 1é€šç›®ã®é€ä¿¡å¤±æ•—: {text1}")

    # 2é€šç›®ï¼šç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆ
    if not free_comment.strip():
        st.warning("ç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚2é€šç›®ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã™ã€‚")
    else:
        comment_message = f"ğŸš¨ã€ç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆã€‘ã•ã‚‰ãªã‚‹æ”¹å–„ã«å‘ã‘ã¦\n\n{free_comment.strip()}"
        status2, text2 = send_line_message(group_id, comment_message, CHANNEL_ACCESS_TOKEN)
        if status2 == 200:
            st.success("âœ… 2é€šç›®ï¼ˆç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆï¼‰ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚")
            comment_sent_marker_path.touch()
        else:
            st.error(f"âŒ 2é€šç›®ã®é€ä¿¡å¤±æ•—: {text2}")

# é€ä¿¡çŠ¶æ³è¡¨ç¤º
if sent_marker_path.exists():
    st.info("âœ… 1é€šç›®ï¼ˆå€‹åˆ¥ãƒ¬ãƒãƒ¼ãƒˆï¼‰ã¯æ—¢ã«é€ä¿¡ã•ã‚Œã¦ã„ã¾ã™ã€‚")
if comment_sent_marker_path.exists():
    st.info("âœ… 2é€šç›®ï¼ˆç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆï¼‰ã¯æ—¢ã«é€ä¿¡ã•ã‚Œã¦ã„ã¾ã™ã€‚")

app.pyã§ã™
ChatGPT:
ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼app.pyã®ã‚³ãƒ¼ãƒ‰ã¯éå¸¸ã«æ•´ç†ã•ã‚Œã¦ã„ã¦ã€ç›®çš„ã‚‚æ˜ç¢ºã§ã™ã€‚
ãŸã ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿éƒ¨åˆ†ã§ã€Œæ—¥ä»˜ã ã‘ã®ãƒ•ã‚¡ã‚¤ãƒ«åã€ã«ä¾å­˜ã—ã¦ã„ã‚‹ãŸã‚ã€å‰è¿°ã®é€šã‚Šä»¥ä¸‹ã®ä¿®æ­£ãŒå¿…è¦ã§ã™ã€‚

ğŸ”§ ä¿®æ­£ãƒã‚¤ãƒ³ãƒˆï¼ˆãƒ•ã‚¡ã‚¤ãƒ«åã«æ—¥ä»˜ãŒå«ã¾ã‚Œã‚‹ã‚‚ã®ã‚’æŸ”è»Ÿã«æ¢ç´¢ï¼‰
âœ… ä¿®æ­£å‰ï¼ˆç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰ï¼‰ï¼š
file_path = DATA_FOLDER / f"{file_date_str}.xlsx"

# ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
if file_path.exists():
    df = pd.read_excel(file_path)
else:
    st.error("æŒ‡å®šã•ã‚ŒãŸæ—¥ä»˜ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚")
    st.stop()
âœ… ä¿®æ­£å¾Œï¼ˆglobã§æ—¥ä»˜ã‚’å«ã‚€ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æ¤œç´¢ï¼‰ï¼š
ä»¥ä¸‹ã«å®‰å…¨ãªæ—¥ä»˜æ¤œç´¢ï¼‹Streamlitã‚¨ãƒ©ãƒ¼è¡¨ç¤ºä»˜ãã®ä¿®æ­£ã‚’æç¤ºã—ã¾ã™ï¼š

import glob

# æ—¥ä»˜ã«ä¸€è‡´ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œç´¢
file_pattern = str(DATA_FOLDER / f"*{file_date_str}*.xlsx")
matching_files = glob.glob(file_pattern)

if matching_files:
    file_path = Path(matching_files[0])  # æœ€åˆã«è¦‹ã¤ã‹ã£ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨
    df = pd.read_excel(file_path)
    st.success(f"âœ… èª­ã¿è¾¼ã‚“ã ãƒ•ã‚¡ã‚¤ãƒ«: {file_path.name}")
else:
    st.error(f"âŒ æŒ‡å®šã•ã‚ŒãŸæ—¥ä»˜ï¼ˆ{file_date_str}ï¼‰ã‚’å«ã‚€Excelãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚")
    st.stop()
ğŸ§  ã“ã®ä¿®æ­£ã§å¾—ã‚‰ã‚Œã‚‹ãƒ¡ãƒªãƒƒãƒˆ
ãƒ•ã‚¡ã‚¤ãƒ«åãŒ 2025-05-24.xlsx ã§ã‚‚ JP-DEMA...-2025-05-24.xlsx ã§ã‚‚èª­ã¿è¾¼ã‚ã‚‹

æ¯æ—¥ã®ãƒ•ã‚¡ã‚¤ãƒ«åãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ã‚·ã‚¹ãƒ†ãƒ ã§ã‚‚æŸ”è»Ÿã«å¯¾å¿œ

ã‚¨ãƒ©ãƒ¼åŸå› ã®ç‰¹å®šãŒã—ã‚„ã™ããªã‚‹

âœ… è£œè¶³ï¼ˆä»Šå¾Œæ”¹å–„ã™ã‚‹ãªã‚‰ï¼‰
åŒã˜æ—¥ä»˜ã§è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹å ´åˆã®é¸æŠè‚¢ï¼ˆè¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒªã‚¹ãƒˆã§è¡¨ç¤ºã—ã¦é¸ã°ã›ã‚‹ï¼‰

ãƒ•ã‚¡ã‚¤ãƒ«åã®å‘½åè¦å‰‡ãŒæ±ºã¾ã£ã¦ã„ã‚‹ãªã‚‰ã€æ­£è¦è¡¨ç¾ãªã©ã§ã‚‚ã£ã¨ç²¾å¯†ã«æŒ‡å®šå¯èƒ½

ã“ã®ä¿®æ­£ã‚’ app.py ã®è©²å½“ç®‡æ‰€ã«ãã®ã¾ã¾è²¼ã‚Šä»˜ã‘ã‚Œã°å‹•ä½œã™ã‚‹ã¯ãšã§ã™ã€‚
å¿…è¦ã§ã‚ã‚Œã°ã€ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠUIã‚’è¿½åŠ ã™ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚‚ä½œæˆå¯èƒ½ã§ã™ã€‚

ã‚ãªãŸ:
import streamlit as st
import pandas as pd
import datetime
import requests
from pathlib import Path

# å®šæ•°å®šç¾©
DATA_FOLDER = Path("data")
FREE_COMMENT_FILE = DATA_FOLDER / "free_comment.txt"
CHANNEL_ACCESS_TOKEN = st.secrets["line"]["channel_access_token"]

# ã‚¿ã‚¤ãƒˆãƒ«
st.title("ContactçŠ¶æ³å¯è¦–åŒ–ã‚¢ãƒ—ãƒªğŸ“Š")

# æ—¥ä»˜é¸æŠ
selected_date = st.date_input("ğŸ“… ç¢ºèªã™ã‚‹æ—¥ä»˜ã‚’é¸æŠ", datetime.date.today())
file_date_str = selected_date.strftime("%Y-%m-%d")
file_path = DATA_FOLDER / f"{file_date_str}.xlsx"

# ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
if file_path.exists():
    df = pd.read_excel(file_path)
else:
    st.error("æŒ‡å®šã•ã‚ŒãŸæ—¥ä»˜ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚")
    st.stop()

# æœªå¯¾å¿œãƒ‡ãƒ¼ã‚¿æŠ½å‡º
no_contact_df = df[df["contact_status"] == "no_contact"]
impact_drivers = df[df["impact"] == "high"]["driver_name"].unique()

# è¡¨ç¤º
st.subheader("ğŸ“Œ æœªå¯¾å¿œãƒ‰ãƒ©ã‚¤ãƒãƒ¼ä¸€è¦§")
if no_contact_df.empty:
    st.success("æœªå¯¾å¿œã®ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã¯ã„ã¾ã›ã‚“ã€‚")
else:
    st.dataframe(no_contact_df[["driver_name", "detail"]])

st.subheader("ğŸš€ æ”¹å–„ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã®é«˜ã„ãƒ‰ãƒ©ã‚¤ãƒãƒ¼")
if len(impact_drivers) > 0:
    st.write("ã€".join(impact_drivers))
else:
    st.write("è©²å½“è€…ãªã—")

# ç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›
st.subheader("ğŸ“ ç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›")
if FREE_COMMENT_FILE.exists():
    default_comment = FREE_COMMENT_FILE.read_text(encoding="utf-8")
else:
    default_comment = ""
free_comment = st.text_area("æ”¹å–„ã®ãƒã‚¤ãƒ³ãƒˆã‚„åŠ±ã¾ã—ã‚³ãƒ¡ãƒ³ãƒˆãªã©", value=default_comment, height=150)
FREE_COMMENT_FILE.write_text(free_comment, encoding="utf-8")

# ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç”Ÿæˆé–¢æ•°ï¼ˆ1é€šç›®ï¼‰
def generate_message(no_contact_df: pd.DataFrame, selected_date: datetime.date) -> str:
    date_str = selected_date.strftime("%-mæœˆ%-dæ—¥")
    message_lines = [f"ğŸ“¢ã€æœªå¯¾å¿œãƒ‰ãƒ©ã‚¤ãƒãƒ¼é€£çµ¡ã€‘{date_str}æ™‚ç‚¹\n"]

    grouped = no_contact_df.groupby("driver_name")
    for name, group in grouped:
        count = len(group)
        message_lines.append(f"ğŸš¨ {name} ã•ã‚“ï¼ˆæœªå¯¾å¿œ {count} ä»¶ï¼‰")

    message_lines.append("\nã”å¯¾å¿œã®ã»ã©ã€ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ã€‚")
    return "\n".join(message_lines)

# LINEé€ä¿¡é–¢æ•°ï¼ˆMessaging API ä½¿ç”¨ï¼‰
def send_line_message(to: str, message: str, token: str):
    headers = {
        "Content-Type": "application/json",
        "Authorization": f"Bearer {token}"
    }
    payload = {
        "to": to,
        "messages": [
            {
                "type": "text",
                "text": message
            }
        ]
    }
    response = requests.post("https://api.line.me/v2/bot/message/push", json=payload, headers=headers)
    return response.status_code, response.text

# ãƒ•ãƒ©ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹
sent_marker_path = DATA_FOLDER / f"message1_sent_flag_{file_date_str}.txt"
comment_sent_marker_path = DATA_FOLDER / f"message2_sent_flag_{file_date_str}.txt"

# ã¾ã¨ã‚ã¦é€ä¿¡ãƒœã‚¿ãƒ³
st.subheader("âœ… å€‹åˆ¥æ”¹å–„ãƒ¬ãƒãƒ¼ãƒˆï¼‹ç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆã¾ã¨ã‚ã¦é€šçŸ¥")
group_id = st.secrets["line"]["group_id"]

if st.button("ğŸ“¬ã¾ã¨ã‚ã¦é€ä¿¡ï¼ˆ1é€šç›®ï¼‹2é€šç›®ï¼‰"):
    # 1é€šç›®ï¼šå€‹åˆ¥ãƒ¬ãƒãƒ¼ãƒˆ
    if len(no_contact_df) == 0:
        st.warning("æœªå¯¾å¿œã®ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ãŒã„ã¾ã›ã‚“ã€‚1é€šç›®ã®é€ä¿¡ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã™ã€‚")
    else:
        message1 = generate_message(no_contact_df, selected_date)
        status1, text1 = send_line_message(group_id, message1, CHANNEL_ACCESS_TOKEN)
        if status1 == 200:
            st.success("âœ… 1é€šç›®ï¼ˆå€‹åˆ¥ãƒ¬ãƒãƒ¼ãƒˆï¼‰ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚")
            sent_marker_path.touch()
        else:
            st.error(f"âŒ 1é€šç›®ã®é€ä¿¡å¤±æ•—: {text1}")

    # 2é€šç›®ï¼šç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆ
    if not free_comment.strip():
        st.warning("ç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚2é€šç›®ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã™ã€‚")
    else:
        comment_message = f"ğŸš¨ã€ç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆã€‘ã•ã‚‰ãªã‚‹æ”¹å–„ã«å‘ã‘ã¦\n\n{free_comment.strip()}"
        status2, text2 = send_line_message(group_id, comment_message, CHANNEL_ACCESS_TOKEN)
        if status2 == 200:
            st.success("âœ… 2é€šç›®ï¼ˆç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆï¼‰ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚")
            comment_sent_marker_path.touch()
        else:
            st.error(f"âŒ 2é€šç›®ã®é€ä¿¡å¤±æ•—: {text2}")

# é€ä¿¡çŠ¶æ³è¡¨ç¤º
if sent_marker_path.exists():
    st.info("âœ… 1é€šç›®ï¼ˆå€‹åˆ¥ãƒ¬ãƒãƒ¼ãƒˆï¼‰ã¯æ—¢ã«é€ä¿¡ã•ã‚Œã¦ã„ã¾ã™ã€‚")
if comment_sent_marker_path.exists():
    st.info("âœ… 2é€šç›®ï¼ˆç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆï¼‰ã¯æ—¢ã«é€ä¿¡ã•ã‚Œã¦ã„ã¾ã™ã€‚")
ä¿®æ­£ã—ãŸã‚³ãƒ¼ãƒ‰ã«ã—ã¦
ChatGPT:
ä»¥ä¸‹ã¯ã€ã‚ãªãŸã®ç›®çš„ï¼ˆLINEé€šçŸ¥ã‚’1é€šç›®ã¨2é€šç›®ã§ã¾ã¨ã‚ã¦é€ã‚Šã€ã™ã§ã«é€ä¿¡æ¸ˆã¿ã®å ´åˆã¯ã€Œå†é€ä¿¡ã€ãƒœã‚¿ãƒ³ã«å¤‰åŒ–ï¼‰ã‚’æº€ãŸã™ã‚ˆã†ã«ã€app.pyã‚’æ”¹å–„ã—ãŸä¿®æ­£ç‰ˆã§ã™ã€‚

âœ… ä¿®æ­£å†…å®¹ã®ãƒã‚¤ãƒ³ãƒˆ
ãƒœã‚¿ãƒ³è¡¨ç¤ºãŒã€ŒğŸ“¬ã¾ã¨ã‚ã¦é€ä¿¡ã€ã‹ã€ŒğŸ”å†é€ä¿¡ã€ã«ãªã‚‹ã‚ˆã†ã«åˆ†å²

é€ä¿¡ã®æœ‰ç„¡ã‚’ãƒœã‚¿ãƒ³è¡¨ç¤ºã«åæ˜ 

å„é€ä¿¡ãŒæˆåŠŸã—ãŸå ´åˆã«ãƒãƒ¼ã‚«ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–°

ğŸ”§ ä¿®æ­£ç‰ˆ app.py
import streamlit as st
import pandas as pd
import datetime
import requests
from pathlib import Path

# å®šæ•°å®šç¾©
DATA_FOLDER = Path("data")
FREE_COMMENT_FILE = DATA_FOLDER / "free_comment.txt"
CHANNEL_ACCESS_TOKEN = st.secrets["line"]["channel_access_token"]

# ã‚¿ã‚¤ãƒˆãƒ«
st.title("ContactçŠ¶æ³å¯è¦–åŒ–ã‚¢ãƒ—ãƒªğŸ“Š")

# æ—¥ä»˜é¸æŠ
selected_date = st.date_input("ğŸ“… ç¢ºèªã™ã‚‹æ—¥ä»˜ã‚’é¸æŠ", datetime.date.today())
file_date_str = selected_date.strftime("%Y-%m-%d")
file_path = DATA_FOLDER / f"{file_date_str}.xlsx"

# ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
if file_path.exists():
    df = pd.read_excel(file_path)
else:
    st.error("æŒ‡å®šã•ã‚ŒãŸæ—¥ä»˜ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚")
    st.stop()

# æœªå¯¾å¿œãƒ‡ãƒ¼ã‚¿æŠ½å‡º
no_contact_df = df[df["contact_status"] == "no_contact"]
impact_drivers = df[df["impact"] == "high"]["driver_name"].unique()

# è¡¨ç¤º
st.subheader("ğŸ“Œ æœªå¯¾å¿œãƒ‰ãƒ©ã‚¤ãƒãƒ¼ä¸€è¦§")
if no_contact_df.empty:
    st.success("æœªå¯¾å¿œã®ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã¯ã„ã¾ã›ã‚“ã€‚")
else:
    st.dataframe(no_contact_df[["driver_name", "detail"]])

st.subheader("ğŸš€ æ”¹å–„ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã®é«˜ã„ãƒ‰ãƒ©ã‚¤ãƒãƒ¼")
if len(impact_drivers) > 0:
    st.write("ã€".join(impact_drivers))
else:
    st.write("è©²å½“è€…ãªã—")

# ç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›
st.subheader("ğŸ“ ç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›")
if FREE_COMMENT_FILE.exists():
    default_comment = FREE_COMMENT_FILE.read_text(encoding="utf-8")
else:
    default_comment = ""
free_comment = st.text_area("æ”¹å–„ã®ãƒã‚¤ãƒ³ãƒˆã‚„åŠ±ã¾ã—ã‚³ãƒ¡ãƒ³ãƒˆãªã©", value=default_comment, height=150)
FREE_COMMENT_FILE.write_text(free_comment, encoding="utf-8")

# ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç”Ÿæˆé–¢æ•°
def generate_message(no_contact_df: pd.DataFrame, selected_date: datetime.date) -> str:
    date_str = selected_date.strftime("%-mæœˆ%-dæ—¥")
    message_lines = [f"ğŸ“¢ã€æœªå¯¾å¿œãƒ‰ãƒ©ã‚¤ãƒãƒ¼é€£çµ¡ã€‘{date_str}æ™‚ç‚¹\n"]
    grouped = no_contact_df.groupby("driver_name")
    for name, group in grouped:
        count = len(group)
        message_lines.append(f"ğŸš¨ {name} ã•ã‚“ï¼ˆæœªå¯¾å¿œ {count} ä»¶ï¼‰")
    message_lines.append("\nã”å¯¾å¿œã®ã»ã©ã€ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ã€‚")
    return "\n".join(message_lines)

# LINEé€ä¿¡é–¢æ•°
def send_line_message(to: str, message: str, token: str):
    headers = {
        "Content-Type": "application/json",
        "Authorization": f"Bearer {token}"
    }
    payload = {
        "to": to,
        "messages": [
            {
                "type": "text",
                "text": message
            }
        ]
    }
    response = requests.post("https://api.line.me/v2/bot/message/push", json=payload, headers=headers)
    return response.status_code, response.text

# ãƒ•ãƒ©ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹
sent_marker_path = DATA_FOLDER / f"message1_sent_flag_{file_date_str}.txt"
comment_sent_marker_path = DATA_FOLDER / f"message2_sent_flag_{file_date_str}.txt"

# é€ä¿¡æ¸ˆã¿ãƒ•ãƒ©ã‚°ãƒã‚§ãƒƒã‚¯
message1_sent = sent_marker_path.exists()
message2_sent = comment_sent_marker_path.exists()

# ãƒœã‚¿ãƒ³ãƒ©ãƒ™ãƒ«ã‚’åˆ‡ã‚Šæ›¿ãˆ
if message1_sent and message2_sent:
    button_label = "ğŸ”å†é€ä¿¡ï¼ˆ1é€šç›®ï¼‹2é€šç›®ï¼‰"
else:
    button_label = "ğŸ“¬ã¾ã¨ã‚ã¦é€ä¿¡ï¼ˆ1é€šç›®ï¼‹2é€šç›®ï¼‰"

# é€šçŸ¥ã‚»ã‚¯ã‚·ãƒ§ãƒ³
st.subheader("âœ… å€‹åˆ¥æ”¹å–„ãƒ¬ãƒãƒ¼ãƒˆï¼‹ç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆã¾ã¨ã‚ã¦é€šçŸ¥")
group_id = st.secrets["line"]["group_id"]

if st.button(button_label):
    # 1é€šç›®ï¼šå€‹åˆ¥ãƒ¬ãƒãƒ¼ãƒˆ
    if len(no_contact_df) == 0:
        st.warning("æœªå¯¾å¿œã®ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ãŒã„ã¾ã›ã‚“ã€‚1é€šç›®ã®é€ä¿¡ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã™ã€‚")
    else:
        message1 = generate_message(no_contact_df, selected_date)
        status1, text1 = send_line_message(group_id, message1, CHANNEL_ACCESS_TOKEN)
        if status1 == 200:
            st.success("âœ… 1é€šç›®ï¼ˆå€‹åˆ¥ãƒ¬ãƒãƒ¼ãƒˆï¼‰ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚")
            sent_marker_path.touch()
        else:
            st.error(f"âŒ 1é€šç›®ã®é€ä¿¡å¤±æ•—: {text1}")

    # 2é€šç›®ï¼šç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆ
    if not free_comment.strip():
        st.warning("ç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚2é€šç›®ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã™ã€‚")
    else:
        comment_message = f"ğŸš¨ã€ç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆã€‘ã•ã‚‰ãªã‚‹æ”¹å–„ã«å‘ã‘ã¦\n\n{free_comment.strip()}"
        status2, text2 = send_line_message(group_id, comment_message, CHANNEL_ACCESS_TOKEN)
        if status2 == 200:
            st.success("âœ… 2é€šç›®ï¼ˆç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆï¼‰ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚")
            comment_sent_marker_path.touch()
        else:
            st.error(f"âŒ 2é€šç›®ã®é€ä¿¡å¤±æ•—: {text2}")

# é€ä¿¡çŠ¶æ³è¡¨ç¤º
if message1_sent:
    st.info("âœ… 1é€šç›®ï¼ˆå€‹åˆ¥ãƒ¬ãƒãƒ¼ãƒˆï¼‰ã¯æ—¢ã«é€ä¿¡ã•ã‚Œã¦ã„ã¾ã™ã€‚")
if message2_sent:
    st.info("âœ… 2é€šç›®ï¼ˆç®¡ç†è€…ã‚³ãƒ¡ãƒ³ãƒˆï¼‰ã¯æ—¢ã«é€ä¿¡ã•ã‚Œã¦ã„ã¾ã™ã€‚")
âœ… è£œè¶³
button_label ã‚’é€ä¿¡æ¸ˆã¿çŠ¶æ³ã«ã‚ˆã£ã¦åˆ‡ã‚Šæ›¿ãˆã‚‹ã“ã¨ã§ã€Œé€ä¿¡ or å†é€ä¿¡ã€ãƒœã‚¿ãƒ³ãŒå®Ÿç¾ã•ã‚Œã¾ã™ã€‚

ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã®ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã¯é¸æŠæ—¥ã”ã¨ã«å€‹åˆ¥ã§ç®¡ç†ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€æ—¥ä»˜ã‚’åˆ‡ã‚Šæ›¿ãˆãŸã¨ãã®é€ä¿¡æ¸ˆã¿ãƒã‚§ãƒƒã‚¯ã‚‚æ­£ç¢ºã§ã™ã€‚

ä½•ã‹ä»–ã«ã‚‚è¿½åŠ ã—ãŸã„æ©Ÿèƒ½ãŒã‚ã‚Œã°æ°—è»½ã«ã©ã†ãï¼




é¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“é¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“
ChatGPT ã®å›ç­”ã¯å¿…ãšã—ã‚‚æ­£ã—ã„ã¨ã¯é™ã‚Šã¾ã›ã‚“ã€‚é‡è¦ãªæƒ…å ±ã¯ç¢ºèªã™ã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚
